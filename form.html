<!DOCTYPE html>
<html data-bs-theme="light" lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Form</title>
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800&amp;display=swap">
    <style>
        /* Style the modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            max-width: 80%;
            max-height: 80%;
            overflow-y: auto;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-md fixed-top navbar-shrink py-3 navbar-light" id="mainNav">
        <div class="container"><a class="navbar-brand d-flex align-items-center" href="/"><span>UiTM</span></a><button data-bs-toggle="collapse" class="navbar-toggler" data-bs-target="#navcol-1"><span class="visually-hidden">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navcol-1">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link active" href="form.html">Form</a></li>
                    <li class="nav-item"><a class="nav-link" href="about.html">About</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <section class="py-5 mt-5">
        <div class="container-xxl py-5"> <!-- Update the container class -->
            <div class="row">
                <div class="col-md-12 col-lg-10 col-xl-8 text-center mx-auto"> <!-- Adjusted grid classes -->
                    <h2 class="display-6 fw-bold mb-4">University <span class="underline">Vehicle</span>&nbsp; Application Form</h2>
                    <p class="text-muted">Fill in the details and make sure it is correct.</p>
                </div>
            </div>
            <div class="row d-flex justify-content-center">
                <div class="col-md-6 col-lg-7 col-xl-6">
                    <div>
                        <form class="p-3 p-xl-4" method="post" data-bs-theme="light" onsubmit="return validate(event, this);">
                            <!-- Form content -->
                            <fieldset>
                                <legend>Type of Vehicle</legend>
                                <div class="form-check form-check-inline"><input class="form-check-input" type="radio" id="car" name="vehicle" value="car"><label class="form-check-label" for="car">Car</label></div>
                                <div class="form-check form-check-inline"><input class="form-check-input" type="radio" id="bus" name="vehicle" value="bus"><label class="form-check-label" for="bus">Bus</label></div>
                                <div class="form-check form-check-inline"><input class="form-check-input" type="radio" id="mpv" name="vehicle" value="mpv"><label class="form-check-label" for="mpv">MPV</label></div>
                                <div class="form-check form-check-inline"><input class="form-check-input" type="radio" id="van" name="vehicle" value="van"><label class="form-check-label" for="van">Van</label></div>
                                <div class="form-check form-check-inline"><input class="form-check-input" type="radio" id="fourwd" name="vehicle" value="4wd"><label class="form-check-label" for="fourwd">4WD</label></div>
                                <div class="form-check form-check-inline"><input class="form-check-input" type="radio" id="lorry" name="vehicle" value="lorry"><label class="form-check-label" for="lorry">Lorry</label></div>
                            </fieldset>
                            <fieldset>
                                <legend>Vehicle Requirement</legend>
                                <div class="form-check form-check-inline"><input class="form-check-input" type="radio" id="dropOffandPickUp" name="vehicleReq" value="dropAndPickup"><label class="form-check-label" for="dropOffandPickUp">Drop Off and Pick Up</label></div>
                                <div class="form-check form-check-inline"><input class="form-check-input" type="radio" id="throughout" name="vehicleReq" value="throughout"><label class="form-check-label" for="throughout">Used Throughout Program</label></div>
                            </fieldset>
                            <div class="mb-3">
                                <legend>Applicant's Details</legend><input class="shadow form-control" type="text" id="applicantName" name="applicantName" placeholder="Name">
                                <div class="mb-3"></div><select class="shadow form-select" name="position">
                                    <optgroup label="Staff or Student">
                                        <option value="staff">Staff</option>
                                        <option value="student">Student</option>
                                    </optgroup>
                                </select>
                                <div class="mb-3"></div><input class="shadow form-control" type="text" name="Division" placeholder="Division (Faculty)">
                                <div class="shadow mb-3"></div><input class="shadow form-control" type="text" name="id" placeholder="Staff / Student ID">
                            </div>
                            <div class="mb-3">
                                <legend>User / Escort Officer</legend><input class="shadow form-control" type="text" id="escortName" name="escortName" placeholder="Name">
                                <div class="mb-3"></div><input class="shadow form-control" type="text" name="positionOfficer" placeholder="Position (eg: lecturer)">
                                <div class="shadow mb-3"></div><input class="shadow form-control" type="text" name="telNoOfficer" placeholder="Telephone No.">
                            </div>
                            <div class="mb-3">
                                <legend>Usage Details</legend><input class="shadow form-control" type="text" id="purpose" name="purpose" placeholder="Purpose">
                                <div class="mb-3"></div><input class="form-control" type="number" name="totalPassenger" placeholder="Total Passenger" max="44" min="0">
                                <div class="shadow mb-3"></div><input class="shadow form-control" type="text" name="destination" placeholder="Destination">
                                <div class="shadow mb-3"></div><input class="shadow form-control" type="text" name="pickupPoint" placeholder="Pick Up Point">
                                <div class="shadow mb-3"></div><input class="shadow form-control" type="text" name="returnDestination" placeholder="Return Destination">
                            </div>
                            <div class="mb-3">
                                <legend>Travel Details</legend><label class="form-label">Departure Date</label><input class="shadow form-control" type="date" name="departDate">
                                <div class="mb-3"></div><label class="form-label">Departure Time</label><input class="shadow form-control" type="time" name="departTime">
                                <div class="shadow mb-3"></div><label class="form-label">Return Date</label><input class="shadow form-control" type="date" name="returnDate">
                                <div class="mb-3"></div><label class="form-label">Return Time</label><input class="shadow form-control" type="time" name="returnTime">
                            </div>
                            <div class="mb-3">
                                <legend>Passenger List</legend>
                                <div class="table-responsive">
                                    <table id="passengerTable" class="table">
                                        <thead>
                                            <tr>
                                                <th>Name</th>
                                                <th>IC No.</th>
                                                <th>Position</th>
                                                <th>ID</th>
                                                <th>Action</th> <!-- New column for the delete button -->
                                            </tr>
                                        </thead>
                                        <tbody id="passengerTableBody"> <!-- Give an ID to the table body for easier reference -->
                                            <tr id="row0"> <!-- Adding an ID to the initial row for identification -->
                                                <td><input class="shadow form-control" type="text" name="namePassenger[]" placeholder="Name"></td>
                                                <td><input class="shadow form-control" type="text" name="icNumPassenger[]" placeholder="IC No."></td>
                                                <td><input class="shadow form-control" type="text" name="positionPassenger[]" placeholder="Position (eg: lecturer)"></td>
                                                <td><input class="shadow form-control" type="text" name="idPassenger[]" placeholder="ID"></td>
                                                <td><button class="btn btn-danger btn-sm" onclick="deleteRow(this)">Delete</button></td> <!-- Delete button column -->
                                            </tr>
                                        </tbody>
                                        
                                        </tbody>
                                    </table>
                                </div>
                                <div class="mb-3">
                                    <!-- Add Row button -->
                                    <a href="javascript:void(0);" class="add-row-button" onclick="addRow('passengerTable')">Add Row</a>
                                </div>
                            </div>
                            
                            <div>
                                <!-- Add a button to trigger the displayFormValues function -->
                                <button type="submit" onclick="validate(event, this.form); printFormData();">Submit</button>

                                <!-- <button class="btn btn-primary shadow d-block w-100" type="submit">Submit</button>
                                <div class="shadow mb-3"></div> -->
                            </div>
        
                            <div><button class="btn btn-primary shadow d-block w-100" type="reset">Reset</button></div>
                            
                            <!-- Add this div in your HTML body -->
                            <div id="formValuesDisplay"></div>

                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section id="formValuesDisplay" class="py-5 mt-5">
        <div class="container-xxl">
            <!-- Form values will be displayed here -->
        </div>
    </section>
    <footer>
        <div class="container py-4 py-lg-5">
            <div class="row row-cols-2 row-cols-md-4 justify-content-center">
                <div class="col-12 col-md-3">
                    <div class="fw-bold d-flex align-items-center mb-2"><span>Address</span></div>
                    <p class="text-muted">Universiti Teknologi MARA<br>Cawangan Perlis, Kampus Arau,<br>02600 Arau, Perlis.</p>
                </div>
                <div class="col-sm-4 col-md-3 text-lg-start d-flex flex-column">
                    <h3 class="fs-6 fw-bold">Contact Us</h3>
                    <ul class="list-unstyled">
                        <li><a href="#"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icon-tabler-phone">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                    <path d="M5 4h4l2 5l-2.5 1.5a11 11 0 0 0 5 5l1.5 -2.5l5 2v4a2 2 0 0 1 -2 2a16 16 0 0 1 -15 -15a2 2 0 0 1 2 -2"></path>
                                </svg>&nbsp;+604-9882204</a></li>
                        <li><a href="#"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icon-tabler-printer">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                    <path d="M17 17h2a2 2 0 0 0 2 -2v-4a2 2 0 0 0 -2 -2h-14a2 2 0 0 0 -2 2v4a2 2 0 0 0 2 2h2"></path>
                                    <path d="M17 9v-4a2 2 0 0 0 -2 -2h-6a2 2 0 0 0 -2 2v4"></path>
                                    <rect x="7" y="13" width="10" height="8" rx="2"></rect>
                                </svg>&nbsp;+604-9882203</a></li>
                        <li><a href="#">korporatperlis@uitm.edu.my</a></li>
                    </ul>
                </div>
            </div>
            <hr>
            <div class="text-muted d-flex justify-content-between align-items-center pt-3"></div>
            <p class="text-center mb-0">Copyright Â© 2023 Muaz Hazali</p>
        </div>
    </footer>
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="assets/js/startup-modern.js"></script>
</body>

<script>
    function addRow(tableId) {
        var table = document.getElementById(tableId);
        var rowCount = table.rows.length;

        var row = table.insertRow(rowCount);

        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);
        var cell4 = row.insertCell(3);
        var cell5 = row.insertCell(4); // New cell for the delete button

        cell1.innerHTML = "<input class='shadow form-control' type='text' id='" + tableId + "PassName" + rowCount + "' name='" + tableId + "PassName' placeholder='Name'>";
        cell2.innerHTML = "<input class='shadow form-control' type='text' id='" + tableId + "PassIC" + rowCount + "' name='" + tableId + "PassIC' placeholder='IC No.'>";
        cell3.innerHTML = "<input class='shadow form-control' type='text' id='" + tableId + "PassPosition" + rowCount + "' name='" + tableId + "PassPosition' placeholder='Position'>";
        cell4.innerHTML = "<input class='shadow form-control' type='text' id='" + tableId + "PassID" + rowCount + "' name='" + tableId + "PassID' placeholder='Student / Staff ID'>";
        cell5.innerHTML = "<button class='btn btn-danger btn-sm' onclick='deleteRow(this)'>Delete</button>"; // Delete button

        // Set a unique ID for each row for deletion identification
        row.id = "row" + rowCount;
    }

    function deleteRow(row) {
        var rowToDelete = row.parentNode.parentNode;
        rowToDelete.parentNode.removeChild(rowToDelete);
    }

    function getPassengerDetails() {
    var table = document.getElementById('passengerTableBody');
    var passengers = [];

    for (var i = 0; i < table.rows.length; i++) {
        var passenger = {
            'Name': table.rows[i].cells[0].querySelector('input').value,
            'IC No.': table.rows[i].cells[1].querySelector('input').value,
            'Position': table.rows[i].cells[2].querySelector('input').value,
            'ID': table.rows[i].cells[3].querySelector('input').value
        };
        passengers.push(passenger);
    }

    return passengers;
}

    function getCheckedValue(radioGroupName) {
    var radios = document.getElementsByName(radioGroupName);
    for (var i = 0; i < radios.length; i++) {
        if (radios[i].checked) {
            return radios[i].value;
        }
    }
    return '';
}


    function validate(event, form) {
        event.preventDefault();

        var fail = "";
        fail += validateVehicle();
        fail += validateVehicleReq();

        fail += validateAppName(form.applicantName.value);
        fail += validatePosition();
        fail += validateDivision(form.Division.value);
        fail += validateID(form.id.value);
        
        fail += validateEscortName(form.escortName.value);
        fail += validatePositionOfficer(form.positionOfficer.value);
        fail += validateTelNoOfficer(form.telNoOfficer.value);
        
        fail += validatePurpose(form.purpose.value);
        fail += validateTotalPassenger(form.totalPassenger.value);
        fail += validateDestination(form.destination.value);
        fail += validatePickupPoint(form.pickupPoint.value);
        fail += validateReturnDestination(form.returnDestination.value);

        fail += validateNotEmpty(form.departDate.value, 'departure date');
        fail += validateNotEmpty(form.departTime.value, 'departure time');
        fail += validateNotEmpty(form.returnDate.value, 'return date');
        fail += validateNotEmpty(form.returnTime.value, 'return time');

        fail += validateDepartureDate(form.departDate.value);
        fail += validateReturnDate(form.departDate.value, form.returnDate.value);
        fail += validateReturnTime(form.departTime.value, form.returnTime.value);

        // fail += validatePassengerTable();
        
        
        // Add other validations as needed

        // if (fail === "" || fail.trim() === "") {
        //     // If no errors, display the form values
        //     displayFormValues(form);
        //     // If no errors, submit the form
        //     alert("Form has been submitted successfully.");
        //     form.submit();
        // } else {
        //     // If errors exist, display the error messages
        //     alert("Form has not been submitted. Please check the following: \n\n" + fail);
        //     return false;
        // }

        // if (fail === "" || fail.trim() === "") {
        //     // Log to console to check if it reaches here
        //     console.log("Validations passed, about to display form values");
        //     displayFormValues(form);
        //     alert("Form has been submitted successfully.");
        //     return true; // Ensure it returns true after successful validation
        // } else {
        //     // Log to console to check if it enters this block when there are validation errors
        //     console.log("Validation failed, errors present");
        //     alert("Form has not been submitted. Please check the following: \n\n" + fail);
        //     return false;
        // }

        // After all validations pass, inside the 'if' block where you currently have the success alert
        if (fail === "" || fail.trim() === "") {
            // Log to console to check if it reaches here
            console.log("Validations passed, about to display form values");
            displayFormValues(form);
            alert("Form has been submitted successfully.");
            return true; // Ensure it returns true after successful validation
        }
        else {
            // Log to console to check if it enters this block when there are validation errors
            console.log("Validation failed, errors present");
            alert("Form has not been submitted. Please check the following: \n\n" + fail);
            return false;
        }

    }

function validateVehicle() {
    var vehicles = document.getElementsByName('vehicle');
    var checked = false;
    
    for (var i = 0; i < vehicles.length; i++) {
        if (vehicles[i].checked) {
            checked = true;
            break;
        }
    }
    
    if (!checked) {
        return "Please select a vehicle\n";
    }
    
    return "";
}

function validateVehicleReq() {
    var vehicleReqs = document.getElementsByName('vehicleReq');
    var checked = false;
    
    for (var i = 0; i < vehicleReqs.length; i++) {
        if (vehicleReqs[i].checked) {
            checked = true;
            break;
        }
    }
    
    if (!checked) {
        return "Please select a vehicle requirement\n";
    }
    
    return "";
}

function validatePosition() {
    var position = document.getElementsByName('position')[0].value;

    if (position === "") {
        return "Please select Staff or Student\n";
    }

    return "";
}


function validateAppName(field) {
    if (field === "") {
        return "Please fill in the applicant's name.\n";
    }
    return "";
}


function validateID(field) {
    if (field == "") {
        //alert("Sila isi ID Pemohon!");
        return "Please enter valid ID \n";
    }

    return "";
}

function validateDivision(field) {
    if (field == "") {
        return "Please enter division \n";
    }
    return "";
}

function validateTelNoOfficer(field) {
    if (field.length < 10 || field.length > 15) {
        return "Invalid Telephone Number \n";
    }
    return "";
}

function validatePositionOfficer(field) {
    field = field.toUpperCase();
    if (field == "") {
        return "Invalid Officer Position \n";
    }

    return "";
}

function validateEscortName(field) {
    if (field == "") {
        return "Please enter escort name \n";
    }
    return "";
}

function validateTotalPassenger(totalPassenger) {
    if (totalPassenger === "" || isNaN(totalPassenger) || totalPassenger <= 0 || totalPassenger > 44) {
        return "Please enter a valid number of passengers (1 to 44)\n";
    }

    return "";
}

function validateDestination(destination) {
    if (destination.trim() === "") {
        return "Please enter a destination\n";
    }

    return "";
}


function validatePickupPoint(field) {
    if (field == "") {
        return "Please enter pickup point \n";
    }
    return "";
}

function validateReturnDestination(field) {
    if (field == "") {
        return "Please enter return destination \n";
    }
    return "";
}

function validatePurpose(field) {
    if (field == "") {
        return "Please enter purpose \n";
    }
    return "";
}

function validateReturnTime(departTime, returnTime) {
    if (departTime >= returnTime) {
        return "Return time must be after the departure time\n";
    }

    return "";
}

function validateReturnDate(departDate, returnDate) {
    let depart = new Date(departDate);
    let ret = new Date(returnDate);

    if (ret < depart) {
        return "Return date must be the same as or after the departure date\n";
    }

    return "";
}

function validateDepartureDate(departDate) {
    let currentDate = new Date();
    currentDate.setDate(currentDate.getDate() + 7); // 7 days after current date

    let chosenDate = new Date(departDate);

    if (chosenDate < currentDate) {
        return 'Departure date must be at least 7 days after the current date\n';
    }

    return '';
}

function validateNotEmpty(value, fieldName) {
    if (!value.trim()) {
        return "Please enter ${fieldName}\n";
    }
    return '';
}

// function validatePassengerTable() {
//     const table = document.getElementById('passengerTableBody');
//     const rows = table.getElementsByTagName('tr');

//     let fail = '';

//     // Check if the first row is empty and there are no subsequent rows
//     if (rows.length === 1) {
//         const inputs = rows[0].getElementsByTagName('input');
//         const name = inputs[0].value.trim();
//         const icNum = inputs[1].value.trim();
//         const position = inputs[2].value.trim();
//         const id = inputs[3].value.trim();

//         if (name === '' || icNum === '' || position === '' || id === '') {
//             fail += 'All fields in the passenger table are required.\n';
//         }
//     } else if (rows.length > 1) {
//         for (let i = 0; i < rows.length; i++) {
//             const inputs = rows[i].getElementsByTagName('input');

//             const name = inputs[0].value.trim();
//             const icNum = inputs[1].value.trim();
//             const position = inputs[2].value.trim();
//             const id = inputs[3].value.trim();

//             if (name === '' || icNum === '' || position === '' || id === '') {
//                 fail += 'All fields in the passenger table are required.\n';
//             }

//             if (icNum.length < 12) {
//                 fail += 'IC Number for passenger ' + (i + 1) + ' should be at least 12 characters.\n';
//             }
//         }
//     } else {
//         fail += 'Please add at least one passenger.\n';
//     }

//     return fail;
// }

function displayFormValues(form) {
    

        var formData = {
            'Type of Vehicle': getCheckedValue('vehicle'),
            'Vehicle Requirement': getCheckedValue('vehicleReq'),
            'Applicant Name': form.applicantName.value,
            'Position': form.position.value,
            'Division': form.Division.value,
            'ID': form.id.value,
            'Escort Name': form.escortName.value,
            'Position Officer': form.positionOfficer.value,
            'Tel. No. Officer': form.telNoOfficer.value,
            'Purpose': form.purpose.value,
            'Total Passenger': form.totalPassenger.value,
            'Destination': form.destination.value,
            'Pick Up Point': form.pickupPoint.value,
            'Return Destination': form.returnDestination.value,
            'Departure Date': form.departDate.value,
            'Departure Time': form.departTime.value,
            'Return Date': form.returnDate.value,
            'Return Time': form.returnTime.value,
            'Passenger Details': getPassengerDetails()
            // Add other form values similarly
        };

        var displayDiv = document.getElementById('formValuesDisplay');
        displayDiv.innerHTML = ''; // Clear previous content

        for (var key in formData) {
        if (formData.hasOwnProperty(key)) {
            var para = document.createElement('p');
            if (key === 'Passenger Details') {
                var passengers = formData[key];
                para.innerHTML = `<strong>${key}:</strong><br>`;
                passengers.forEach(function (passenger, index) {
                    para.innerHTML += `<span>Passenger ${index + 1}:</span><br>`;
                    for (var passengerKey in passenger) {
                        para.innerHTML += `<span>${passengerKey}:</span> ${passenger[passengerKey]}<br>`;
                    }
                });
            } else {
                para.innerHTML = `<strong>${key}:</strong> ${formData[key]}`;
            }
            displayDiv.appendChild(para);
        }
    }
    }

    function printFormData(form) {
    var formData = {
        'Type of Vehicle': getCheckedValue('vehicle'),
        'Vehicle Requirement': getCheckedValue('vehicleReq'),
        'Applicant Name': form.applicantName.value,
        'Position': form.position.value,
        'Division': form.Division.value,
        'ID': form.id.value,
        'Escort Name': form.escortName.value,
        'Position Officer': form.positionOfficer.value,
        'Tel. No. Officer': form.telNoOfficer.value,
        'Purpose': form.purpose.value,
        'Total Passenger': form.totalPassenger.value,
        'Destination': form.destination.value,
        'Pick Up Point': form.pickupPoint.value,
        'Return Destination': form.returnDestination.value,
        'Departure Date': form.departDate.value,
        'Departure Time': form.departTime.value,
        'Return Date': form.returnDate.value,
        'Return Time': form.returnTime.value,
        // Add other form values similarly
    };

    var displayDiv = document.getElementById('formValuesDisplay');
    displayDiv.innerHTML = ''; // Clear previous content

    for (var key in formData) {
        if (formData.hasOwnProperty(key)) {
            var para = document.createElement('p');
            para.innerHTML = `<strong>${key}:</strong> ${formData[key]}`;
            displayDiv.appendChild(para);
        }
    }
}

</script>


</html>